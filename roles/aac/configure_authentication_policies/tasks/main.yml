---

# main task to configure authentication policies
#   Example:
#     authentication_policies:
#       - name: testap1
#         description: test
#         dialect: urn:ibm:security:authentication:policy:1.0:schema
#         enabled: true
#         uri: urn:ibm:security:authentication:asf:testap1
#         policy: '<Policy xmlns="urn:ibm:security:authentication:policy:1.0:schema" PolicyId="urn:ibm:security:authentication:asf:testap1"><Description/><Step id="id16025195966980" type="Authenticator"><Authenticator id="id16025195966991" AuthenticatorId="urn:ibm:security:authentication:asf:mechanism:info_map"/></Step></Policy>'

- name: Configure authentication policies
  ibm.isam.isam:
    log: "{{ log_level | default(omit) }}"
    force: "{{ force | default(omit) }}"
    action: ibmsecurity.isam.aac.authentication.policies.set
    isamapi: "{{ item }}"
  with_items: "{{ authentication_policies }}"
  when: item.name == name
  loop_control:
    label: "{{ item.name }}"
  notify: Commit Changes
