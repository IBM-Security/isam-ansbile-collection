#"4.2 Enable NTP"
ntpServers: "pool.ntp.org"
timeZone: "America/Chicago"

#"4.3 Product Activation"
activation_keys: [{id: wga, code: },
                  {id: mga, code: },
                  {id: federation, code: }
                 ]

#"4.4 Configure Runtime Interfaces"
label:  '1.1'
address:  "192.168.42.202"
maskOrPrefix: "24"
allowManagement: false
enabled: true

#"4.5 Update Hosts File on the Appliance"
host_records: [ { addr: 192.168.42.101, hostnames: isam.myidp.ibm.com },
                { addr: 192.168.42.102, hostnames: www.myidp.ibm.com },
                { addr: 192.168.42.201, hostnames: isam.mysp.ibm.com },
                { addr: 192.168.42.202, hostnames: www.mysp.ibm.com }]


#"4.6 Configure ISAM Runtime Component on the Appliance"
ssl_compliance: "fips"
ps_mode: "local"
admin_cert_lifetime: "1460"
user_registry: "local"
ldap_pwd: "passw0rd"
admin_pwd: "Passw0rd"
policyserver_connection_inactivity: 0

#5.1 Create new Reverse Proxy
https_port: "443"
nw_interface_yn: "yes"
https_yn: "yes"
domain: "Default"
admin_id: "sec_master"
host: "isam.mysp.ibm.com"
inst_name: "default"
ip_address: 192.168.42.202
listening_port: "7234"
ssl_yn: no
http_yn: no

#5.2 Modify Reverse Proxy Instance Settings
set_reverseproxy_conf_entries: [{stanza_id: "server", entries: [["web-host-name", "www.mysp.ibm.com"]]},
                                {stanza_id: "step-up", entries: [["verify-step-up-user", "no"]]},
                                {stanza_id: "session", entries: [["user-session-ids", "yes"],
                                                                 ["inactive-timeout", "1800"],
                                                                 ["create-unauth-sessions", "yes"]
                                                                ]}
                               ]

execute_rp_op_ids: [{id: "default"}]
execute_rp_op_operation: "restart"

#7.1 Upload keystore files
import_certificate_db_kdb: "providedfiles/myspkeys/myspkeys.kdb"
import_certificate_db_sth: "providedfiles/myspkeys/myspkeys.sth"

#7.2 Upload mapping rules
inventory_dir: "providedfiles/mappingrules/sp"
mapping_rules: [ {name: oidc_adv_claims, category: OIDC, file: oidc_adv_claims.js},
                 {name: oidc_adv, category: OIDC, file: oidc_adv.js},
                 {name: sp_saml20_dynamic_group, category: SAML2_0, file: sp_saml20_dynamic_group.js},
                 {name: sp_saml20, category: SAML2_0, file: sp_saml20.js}
               ]

#7.3 Create Federation
search_mapping_rule_name: sp_saml20
spfed: "providedfiles/spfed.json"
fed_name: saml20sp
protocol: SAML2_0
role: sp

#7.4 Export meta-data
export_metadata_filename: "providedfiles/Automation/tmp/spmetadata.xml"

#8.2.1 Configure Reverse Proxy for SP
config_reverseproxy_federation_hostname: "127.0.0.1"
config_reverseproxy_federation_port: "443"
config_reverseproxy_federation_reuse_certs: false
config_reverseproxy_federation_reuse_acls: false

#8.2.2 Environment-specific configuration
set_reverseproxy_conf_entries_8_2_2: [
                                      {stanza_id: "junction:/isam", entries: [["reset-cookies-list", "*ac.uuid,*JSESSIONID"]]}
                                      ]

#8.2.3 Add anonymous user
execute_pdadmin_isamuser: sec_master
execute_pdadmin_isampwd: Passw0rd
execute_pdadmin_commands: ["user create anonymous cn=anonymous,dc=iswga anonymous anonymous Passw0rd", "user modify anonymous account-valid yes"]
